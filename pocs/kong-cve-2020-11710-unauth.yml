name: poc-yaml-kong-cve-2020-11710-unauth
rules:
  - method: GET
    path: /
    follow_redirects: true
    expression: |
      response.status == 200 && "server" in response.headers && response.headers["server"].contains("kong/") && "x-kong-admin-latency" in response.headers && response.body.bcontains(b"Welcome to kong") && response.body.bcontains(b"kong_env")
  - method: GET
    path: /status
    follow_redirects: true
    expression: |
      response.status == 200 && "server" in response.headers && response.headers["server"].contains("kong/") && "x-kong-admin-latency" in response.headers && response.body.bcontains(b"kong_db_cache_miss")
  - method: GET
    path: /endpoints
    follow_redirects: true
    expression: |
      response.status == 200 && "server" in response.headers && response.headers["server"].contains("kong/") && "x-kong-admin-latency" in response.headers && response.body.bcontains(b"/ca_certificates")
detail:
  author: Loneyer
  links:
    - https://mp.weixin.qq.com/s/Ttpe63H9lQe87Uk0VOyMFw
